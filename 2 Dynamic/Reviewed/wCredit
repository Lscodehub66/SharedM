let
    Source = CWB("tbl_review_shortname"),
    DMI_Credit = fx("Ws")("DEALSMASTER", "DMI_Credit"),
    ColNow_mCredit = Table.ColumnNames(fx("Ws")("DEALSMASTER", "mCredit")),
    Filtered = Table.Distinct(Table.SelectRows(Source, each w <> null and [信用主体] <> "")),
    Renamed = Table.RenameColumns(
        Filtered, {{"IN_板块", "板块"}, {"IN.中资属性", "中资属性"}, {"SHORTNAMER", "信用主体简称"}}, MissingField.Ignore
    ),
    MergedQ2 = fx("Merge")(Renamed, DMI_Credit, "信用主体", "信用主体", {"DEBUT_DATE"}, {"DEBUT_DATE"}),
    MergedQ1 = fx("Merge")(MergedQ2, CWB("DLD_Conso_Filter"), "信用主体", "信用主体", {""}, {""}),
    Replaced = Table.ReplaceValue(MergedQ1, null, each [定价日], Replacer.ReplaceValue, {"DEBUT_DATE"}),
    Presenter = fx("PresentNoData")(Replaced),
    SelectedCol =
        if Table.RowCount(
            Table.SelectRows(
                Source, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))
            )
        ) > 0 then
            Table.SelectColumns(Presenter, ColNow_mCredit, MissingField.Ignore)
        else
            Table.SelectColumns(
                Table.SelectRows(
                    Source, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))
                ),
                ColNow_mCredit,
                MissingField.Ignore
            ),
    ACol = Table.AddColumn(SelectedCol, "mCredit", each "Y")
in
    ACol
