(TableName as table, BMKCol as text, NumTextCol as text) =>
    let
        Source = TableName,
        #"Changed TypeText" = Table.TransformColumnTypes(Source, {{BMKCol, type text}, {NumTextCol, type text}}),
        #"Trimmed Text1" = Table.TransformColumns(
            Source, {{BMKCol, Text.Trim, type text}, {NumTextCol, Text.Trim, type text}}
        ),
        #"Replaced Value" = Table.ReplaceValue(#"Trimmed Text1", " ", "", Replacer.ReplaceText, {BMKCol, NumTextCol}),
        #"Duplicated Column1" = Table.DuplicateColumn(#"Replaced Value", NumTextCol, "Upper_Num"),
        #"Changed Type" = Table.TransformColumnTypes(#"Duplicated Column1", {{"Upper_Num", type number}}),
        #"Replaced Errors" = Table.ReplaceErrorValues(#"Changed Type", {{"Upper_Num", null}}),
        NumToText = Table.TransformColumns(
            #"Replaced Errors", {{"Upper_Num", each if _ = null then "" else Number.ToText(_), type text}}
        ),
        #"Added Custom" = Table.AddColumn(
            NumToText,
            "Upper_String",
            each
                if [Upper_Num] = "" or Record.Field(_, BMKCol) ="" then
                    ""
                else if Record.Field(_, BMKCol) = "%" then
                    "-" & [Upper_Num] & Record.Field(_, BMKCol)
                else
                    "-" & [Upper_Num],
            type text
        ),
        RCol = Table.RemoveColumns(#"Added Custom", {"Upper_Num"})
    in
        RCol
