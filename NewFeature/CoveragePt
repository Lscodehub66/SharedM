let
 Source     = Directory, 
 Filtered   = Table.SelectRows ( Source, each [定价日] >= Date.From ( "2022/1/1" ) ), 
 Grouped    = Table.Group ( Filtered, { "年", "COVERAGE" }, { { "TRANCHES", each Table.RowCount ( _ ), Int64.Type } } ),
 // Calculate percent based on category 
 CategoryPt = Table.AddColumn ( Grouped, "当年占比", each [TRANCHES] / Table.SelectRows ( Table.Group ( Grouped, { "年" }, { { "Category Total", each List.Sum ( [TRANCHES] ), type number } } ), each ( [年] = [年] ) ){[ 年 = [年] ]}[Category Total] ), 
 RoundedOff = Table.TransformColumns ( CategoryPt, { { "当年占比", each Number.Round ( _, 2 ), type number } } )
in
 RoundedOff