
let
    Mondaytext = fx("Parameter")("Monday"),
    M1 = Date.From(  Mondaytext),
    ThisWB = Load("ThisWorkbook"),
    Record = [
      
        GPS = try if
            Text.Contains(Record.Field(ThisWB, "FullPath"), "ktkt2", Comparer.OrdinalIgnoreCase)
            or Text.StartsWith(ThisWB, "http", Comparer.OrdinalIgnoreCase)
        then
            "Remote"
        else
            "Global" otherwise fx("Parameter")("GPS")
    ],
  Getppt = let pptfolder =  if Record.Field(Record, "GPS") = "Global" then  "\\itd-m09-fs02\dcm$\Team Folder\Execution Team\Weekly\"
else "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\Weekly\",
pptfile =  Mondaytext  & "\Markets - Weekly Update - " & Mondaytext  & ".pptx" ,
pptpath = pptfolder & pptfile in pptpath,
Record2 = [PPT_Path = Getppt],




  Combined = Record.Combine({Record,Record2 ,ThisWB}) 
in
     Combined
