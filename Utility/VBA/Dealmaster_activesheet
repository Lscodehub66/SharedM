Sub RefreshDataLake()
    '
    ' RefreshDataLake Macro
   Application.CommandBars("Queries and Connections").Visible = True
Range("wDynamic[[#Headers],[Index]]").Select
    ActiveWorkbook.Connections("Query - wIndice").Refresh
    ActiveWorkbook.Connections("Query - wDynamic").Refresh
    ActiveWorkbook.Connections("Query - BBG_SBLCRtg").Refresh

    If Range("GPS") = "Global" Then
        ActiveWorkbook.Connections("Query - ESG_ExternalReview").Refresh
        ActiveWorkbook.Connections("Query - KYC_Master").Refresh
        ActiveWorkbook.Connections("Query - QRC_Compliance").Refresh
        ActiveWorkbook.Connections("Query - QRC_Income").Refresh

    End If


End Sub
Sub RefreshFolderDatabase()
    '
    ' RefreshFolderDatabase Macro
    Application.CommandBars("Queries and Connections").Visible = True
On Error Resume Next
Application.Goto Reference:="Step2_Dashboard"
Range("C8").Activate
    ActiveWorkbook.Connections("Query - Step2_Dashboard").Refresh
    ActiveWorkbook.Connections("Query - mIssue").Refresh
    ActiveWorkbook.Connections("Query - mBond").Refresh
    ActiveWorkbook.Connections("Query - mStats1").Refresh
    ActiveWorkbook.Connections("Query - mChart").Refresh
    ActiveWorkbook.Connections("Query - mBISL(1)").Refresh
    ActiveWorkbook.Connections("Query - mEXE").Refresh
    ActiveWorkbook.Connections("Query - mIndice").Refresh
    ActiveWorkbook.Connections("Query - mCredit").Refresh
Call AutoZoom
Shee24.Activate
    ActiveWindow.Zoom = 100
    Range("C8").Activate

End Sub
Sub RefreshDB()
    '
    ' RefreshFolderDatabase Macro
    Application.CommandBars("Queries and Connections").Visible = True
On Error Resume Next
Application.Goto Reference:="Step2_Dashboard"
Range("C8").Activate
    ActiveWorkbook.Connections("Query - Step2_Dashboard").Refresh
Call QryNZoom("BOND", "mBond", "mChart")
Call QryNZoom("ISSUE", "mIssue", "mStats1")
Call QryNZoom("BOCOM", "mBISL(1)", "mEXE")
Call QryNZoom("CREDIT", "mCredit")
Call QryNZoom("INDICE", "mIndice")



Call AutoZoom
Sheet24.Activate
    ActiveWindow.Zoom = 100
    Range("C8").Activate

End Sub
Function QryNZoom(string1 As String, string2 As String, Optional string3 As String = "")
Sheets(string1).Activate
Range(string2 & "[[#Headers],[Index]]").Select
ActiveWindow.Zoom = 85

 Sheets(string1).ListObjects(string2).QueryTable.Refresh False
 Application.Wait Now + #12:00:03 AM#
 Dim num As Integer
 num = Range(string2).Columns.Count \ 2
 ActiveWindow.SmallScroll ToRight:=num
  Application.Wait Now + #12:00:03 AM#
 If string3 <> "" Then
 Sheets(string1).ListObjects(string3).QueryTable.Refresh False
  Application.Wait Now + #12:00:03 AM#
 End If
End Function
Sub RefreshKeyGraphLoad()
    '
    ' RefreshKeyGraphLoad Macro

     
    ActiveWorkbook.Connections("Query - chart_master").Refresh
    '
  Sheets("3.master").ListObjects("deal_master").QueryTable.Refresh False
      '
Call RefreshDirectory

End Sub

Sub RefreshDirectory()
    '
    ' RefreshDirectory Macro
    '

   Sheets("DIRCTRY").ListObjects("Directory").QueryTable.Refresh False
    '
    ActiveWorkbook.Connections("Query - wTomb").Refresh
    ActiveWorkbook.Connections("Query - CompletedFormalities").Refresh
End Sub
Sub RefreshwTomb()
    '
    ' RefreshwTomb Macro
    '

    '

    ActiveWorkbook.Connections("Query - wTomb").Refresh
    ActiveWorkbook.Connections("Query - CompletedFormalities").Refresh

End Sub
Sub RefreshNewIssueMonitor()
    '
    ' Refresh4NewIssueMonitor Macro
    '

    '
    ActiveWorkbook.Connections("Query - SBLC").Refresh
    ActiveWorkbook.Connections("Query - DimSum").Refresh
    ActiveWorkbook.Connections("Query - ESG").Refresh
    ActiveWorkbook.Connections("Query - FI").Refresh
    ActiveWorkbook.Connections("Query - IGlgfv").Refresh

End Sub
Sub ClearWenDang()
    '
    ' ClearWenDang Macro


    Sheet12.Activate


    Application.Goto Reference:="tbl_WenDang"
    Selection.ClearContents

    Sheet12.Select
    Range("C6").Select

End Sub



'PLACE IN STANDARD MODULE
Sub DemoMacro()
'(Step 1) Display your Progress Bar
ufProgress.LabelProgress.Width = 0
ufProgress.Show
FractionComplete (0) '(Step 2)
    '--------------------------------------
   
     
    ActiveWorkbook.Connections("Query - chart_master").Refresh
    '

      '

    '--------------------------------------
FractionComplete (0.25) '(Step 2)
    '--------------------------------------
    Sheets("3.master").ListObjects("deal_master").QueryTable.Refresh False
    '--------------------------------------
FractionComplete (0.5) '(Step 2)
    '--------------------------------------
 Sheets("DIRCTRY").ListObjects("Directory").QueryTable.Refresh False
    '

    '--------------------------------------
FractionComplete (0.75) '(Step 2)
    '--------------------------------------
    ActiveWorkbook.Connections("Query - wTomb").Refresh

    '--------------------------------------
FractionComplete (1) '(Step 2)
    ActiveWorkbook.Connections("Query - CompletedFormalities").Refresh
'(Step 3) Close the progress bar when you're done
    Unload ufProgress

End Sub

Sub FractionComplete(pctdone As Single)
With ufProgress
    .LabelCaption.Caption = pctdone * 100 & "% Complete"
    .LabelProgress.Width = pctdone * (.FrameProgress.Width)
End With
DoEvents
End Sub

Sub AutoZoom()
Dim ws As Worksheet
Application.ScreenUpdating = False    'Optional
For Each ws In Worksheets
   If ws.Visible = True Then
   ws.Activate
    ActiveWindow.Zoom = 85
    Range("B2").Activate
    End If
Next
Application.ScreenUpdating = True
End Sub

