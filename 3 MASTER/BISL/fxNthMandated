(TableName as table, KeyColList as list) =>
    let
        // KeyColList = { "YYMMDD", "信用主体"},
        Source = Table.Buffer(TableName),
        SelectedCol = Table.SelectColumns(Source, KeyColList),
        RemovedDupe = Table.Distinct(SelectedCol, KeyColList),
        Sorted = Table.Buffer(Table.Sort(RemovedDupe, {{KeyColList{0}, Order.Ascending}})),
        InstanceGp1 = Table.Group(Sorted, {KeyColList{1}}, {{"Data", each _, type table}}),
        IGCustom1 = Table.AddColumn(InstanceGp1, "Custom", each Table.AddIndexColumn([Data], "第N次担任", 1)),
        IGRemoved1 = Table.SelectColumns(IGCustom1, {"Custom"}),
        IGExpanded1 = Table.ExpandTableColumn(IGRemoved1, "Custom", Table.ColumnNames(IGRemoved1[Custom]{0})),
        List2 = List.Transform(KeyColList, each _ & "Dummy"),
        #"Renamed Columns" = Table.RenameColumns(IGExpanded1, List.Zip({KeyColList, List2})),
        Custom2 = Table.Join(Source, KeyColList, #"Renamed Columns", List2, JoinKind.LeftOuter)
    in
        Custom2
