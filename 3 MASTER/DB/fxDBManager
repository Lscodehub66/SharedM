(TableName as table, optional DB_Name as text, optional InventoryMethod as text) =>
    let
        SourceDB = TableName,
        // Definitions fx("DBManager")(Source,"mCredit","LIFO")
        //
        CN_Source = Table.ColumnNames(SourceDB),
        HD = List.Intersect({{"Check", "信用主体", "信用主体(备证行)", "Date", "Timestamp", "板块二级", "BISL_ROLE"}, CN_Source}),
        HD_Count = List.Count(HD),
        MorW = if not List.Contains(HD, "Timestamp") then "W" else "M",
        // Filter out blank rows & invoke dataformat
        NullOut =
            if HD_Count = 0 then
                fx("Data")(SourceDB)
            else
                fx(
                    "Data"
                )(
                    Table.SelectRows(
                        SourceDB,
                        each
                            Record.Field(_, HD{0}) <> null
                            and Record.Field(_, HD{0}) <> ""
                            and Record.Field(_, HD{0}) <> HD{0}
                    )
                ),
        // Recalculate identifiers
        RIdentifier =
            if HD{0} = "Check" then
                Table.ReplaceValue(
                    NullOut,
                    each [Check],
                    each Load("fxCheck")([定价日], "yyMMdd", [ISIN], "Y"),
                    Replacer.ReplaceValue,
                    {"Check"}
                )
            else
                NullOut,
        // 添加Index辅助列，由新到旧index递增
        Indexed = Table.AddIndexColumn(RIdentifier, "Dummy" & "Index", 1, 1),
        //LIFO = Last in, First Out 出现重复，保留较旧的记录，删除新加入的记录：
        //Autocopy - 越新加入index数值越低，删除需要将其排在靠后位置，index因此需要按Descending排列
        //Query- 越新加入index数值越大，删除需要将其排在靠后位置，index因此需要按Ascending排列
        Order = if InventoryMethod = "FIFO" then Order.Ascending else Order.Descending,
        SortedDupe =
            if HD_Count > 0 then
                Table.Buffer(Table.Sort(Indexed, {{HD{0}, Order}, {"Dummy" & "Index", Order}}))
            else
                Indexed,
        RemovedDupe =
            if HD_Count = 0 or HD{0} = "Timestamp" then
                Table.Distinct(SortedDupe)
            else
                Table.Distinct(SortedDupe, {HD{0}}),
        // Weekly
        // Remember to check the referenced name if you revise previous steps **Referenced Dummy Step **
        _CROSSROAD = if MorW = "W" then Load("fxUpdatorTS")(RemovedDupe) else RemovedDupe,
        // Revalidate mCurated
        // Revalidate mBISL BISL_Ancient
        BISL_对帐号 = Load("fxPRJSync")(_CROSSROAD, "台账序号", "定价日", "PRJ对账号"),
        DB_mBISL =
            if List.Contains(CN_Source, "IS_KYC_DONE") and MorW = "M" then
                fx("fxDEALs_ToReplace")(BISL_对帐号)
            else
                _CROSSROAD,
        //  **Referenced Dummy Step ** This step is referenced by the conditional mCredit Manager step as Source !
        DB_Entity = if List.Contains(HD, "板块二级") and MorW = "M" then Load("fxDB_Entity")(DB_mBISL) else DB_mBISL,
        //  **Referenced Dummy Step ** This step is referenced by the conditional sort step - better not to change it !
        FnDBUpdated = if MorW = "M" then fx("DBUpdator")(DB_Entity) else DB_Entity,
        PresentedNull = fx("PresentNoData")(FnDBUpdated),
        //Sort as last step
        RCol = Table.RemoveColumns(
            PresentedNull,
            List.Select(Table.ColumnNames(PresentedNull), each Text.Contains(_, "Dummy")),
            MissingField.Ignore
        ),
        Sorted = fx("SortNIndex")(RCol)
    in
        Sorted
