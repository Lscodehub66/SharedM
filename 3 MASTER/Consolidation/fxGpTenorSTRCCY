(TableName as table) =>
    let
        Source = TableName,
        NewCol = {"年期分类", "结构分类", "货币细分"},
        Prep = Table.RemoveColumns(Source, NewCol, MissingField.Ignore),
        Slicer_Tenor = fx("GroupRange")(Prep, {"年期", "年期分类"}, {"永续", 1, 3, 5}, "年"),
        Slicer_Structure = Table.AddColumn(
                  Slicer_Tenor ,
            "结构分类",
            each
                if List.Contains({null, "", "--"}, [结构]) then
                    "--"
                else if Text.Contains([结构], "(") then
                    Text.BetweenDelimiters([结构], "(", ")")
                else
                    Text.BeforeDelimiter([结构], "+"),
            type text
        ),
        //
        Calculated_CCY = fx(
            "Replace"
        )(
            Table.AddColumn(
                   Slicer_Structure,
                "货币细分",
                each
                    if [ISIN] = null then
                        "--"
                    else if Text.StartsWith([ISIN], "G") and not Text.StartsWith([ISIN], "GB") then
                        "自贸债"
                    else if Text.Contains([货币], "CNH") then
                        "点心债"
                    else
                        [货币] & "债",
                type text
            ),
            {"货币细分"},
            "货币"
        ),
        _input = {{"年期", Slicer_Tenor}, {"结构", Slicer_Structure}, {{"货币", "ISIN"}, Calculated_CCY}},
        Output = List.Accumulate(_input, Prep, (x, y) => if Table.HasColumns(x, y{0}) then y{1} else x)
    in
        Output
