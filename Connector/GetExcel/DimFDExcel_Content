// folderfiles
let
  
    Source = Load("DimFDExcel"),
    Source_FD =     Table.FromList( List.Select(List.Distinct(  Source[FDPath]), each if Text.StartsWith(_,"C:\Users\ktkt2\OneDrive\EXE Team\DataHub\") then _ = "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\" else true)),
    #"Invoked Custom Function" = Table.AddColumn(Source_FD, "Data", each Table.SelectRows(Folder.Files([Column1]), each Text.Contains([Extension], ".xls", 
    Comparer.OrdinalIgnoreCase))),
    #"Expanded Data" = Table.ExpandTableColumn(
        #"Invoked Custom Function",
        "Data",
       {"Content", "Name", "Folder Path"}
    ),
    #"Inserted Text Before Delimiter" = Table.AddColumn(
        #"Expanded Data",
        "FileName.Extracted",
        each
            Text.BeforeDelimiter(
                Text.BeforeDelimiter(Text.BeforeDelimiter([Name], ".", {0, RelativePosition.FromEnd}), "-"), "_"
            ),
        type text
    ),
   // **Skipped**
   #"Merged Columns" = Table.Buffer(
        Table.CombineColumns(
            #"Inserted Text Before Delimiter",
            {"Folder Path", "Name"},
            Combiner.CombineTextByDelimiter("", QuoteStyle.None),
            "File Path"
        )
    ),
    #"Inserted Merged Column" = Table.AddColumn(  #"Inserted Text Before Delimiter", "File Path", each Text.Combine({[Folder Path], [Name]}, ""), type text),
    #"Removed Other Columns" = Table.SelectColumns(#"Inserted Merged Column",{"Content", "File Path", "FileName.Extracted", "Folder Path"})
in
    #"Removed Other Columns"