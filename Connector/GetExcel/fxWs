(_input as text, optional _inputsheet as nullable text) =>
    let
        _rootremote = "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\",
        _folderone = "DataLake\",
        _rootglobal = "\\itd-m09-fs02\dcm$\",
        excelkey = if _input = "DMI" then "美元债一级" else Text.Upper(_input ?? ""),
        sheetkey =
            if List.Contains({"美元债一级", "银行", "违约"}, excelkey) then
                excelkey
            else
                Text.Remove(_inputsheet ?? "", "="),
        yyyyMMdd = Text.Replace(fx("Parameter")("Monday"), "/", ""),
        gps = fx("Parameter")("GPS"),
        RecordOfRecord = [
            DEALSMASTER = "Team Folder\Execution Team\DataHub\DEALs MASTER.xlsm",
            DOWNLOAD = "Team Folder\Execution Team\DataHub\Weekly\" & yyyyMMdd & "\Data\1.Weekly Download.xlsm",
            DYNAMIC = "Team Folder\Execution Team\DataHub\Weekly\" & yyyyMMdd & "\Data\2.Dynamic List Generator.xlsm",
            GRAPH = "Team Folder\Execution Team\DataHub\4 Markets\Data\Graph.xlsm",
            DIRECTORY = "Team Folder\Execution Team\DataHub\4 Markets\DEAL DIRECTORY.xlsm",
            美元债一级 = "Team Folder\Execution Team\DataHub\DataLake\美元债一级.xlsx",
            违约 = "Team Folder\Execution Team\DataHub\DataLake\境外债券违约.xlsx",
            银行 = "Team Folder\Execution Team\DataHub\DataLake\银行指标数据.xlsx",
            YY = "Team Folder\Execution Team\DataHub\DataLake\YY.xlsx",
            BBGFX = "Team Folder\Execution Team\DataHub\DataLake\BBGFX.xlsx",
            ESG = "Team Folder\Execution Team\DataHub\Rating & Advisory\7. ESG\Pitch book\ESG Deal List.xlsx",
            台账21 = "Team Folder\Execution Team\DataHub\DCM2021年台账.xlsx",
            台账22 = "Team Folder\Execution Team\DataHub\DCM2022年台账.xlsx",
            KYC = "Team Folder\Execution Team\DataHub\DCM Existing KYC Master List_19 Oct 2023.xlsx",
            台账23 = "Team Folder\Execution Team\DataHub\DCM台账2023.xlsx",
            台账24 = "Team Folder\Execution Team\DataHub\DCM台账2024.xlsx"
        ],
        Record = try Record.Field(RecordOfRecord, excelkey) otherwise _rootglobal & _input,
        //Global
        #"Global File Contents" = File.Contents(_rootglobal & Record),
        //remote
        RemoteFile = Text.AfterDelimiter(Record, "\", {0, RelativePosition.FromEnd}),
        RemoteFolder = _rootremote & _folderone,
        RemoteDM = _rootremote & RemoteFile,
        Is_WeeklyPath =
            if Text.AfterDelimiter(Record, yyyyMMdd) <> "" then
                _rootremote & "Weekly\" & yyyyMMdd & Text.AfterDelimiter(Record, yyyyMMdd)
            else
                "",
        #"Remote File Selected" = Table.SelectRows(Folder.Files(RemoteFolder), each [Name] = RemoteFile),
        #"Remote File Content" =
            if Is_WeeklyPath = "" then
                #"Remote File Selected"{0}[Content]
            else
                File.Contents(Is_WeeklyPath),
        #"Excel Content" =
            if gps = "Global" then
                Excel.Workbook(#"Global File Contents")
            else if excelkey = "DEALSMASTER" then
                try Excel.Workbook(File.Contents(RemoteDM)) otherwise Excel.Workbook(#"Remote File Content")
            else
                Excel.Workbook(#"Remote File Content"),
        #"ExcelWB" = Table.SelectRows(#"Excel Content", each ([Kind] <> "DefinedName")),
        //fx("ExcelWB")(#">>path"),
        #"Is true" = sheetkey = "",
        #"Is ExactMatch" = Text.StartsWith(_inputsheet ?? "", "="),
        #"Math By" = if #"Is true" = true then
                Table.SelectColumns(
                    Table.Sort(#"ExcelWB", {{"Kind", Order.Descending}, {"Item", Order.Ascending}}),
                    {"Item", "Kind", "Data"}
                )
            else if #"Is ExactMatch" = true then
                Table.SelectRows(#"ExcelWB", each List.Contains({[Item]},sheetkey,Comparer.OrdinalIgnoreCase))
            else
                Table.SelectRows(#"ExcelWB", each Text.Contains([Item], sheetkey, Comparer.OrdinalIgnoreCase)),
        #"Count Filtered" = Table.RowCount(#"Math By"),
        #"Selected Sheet" =
            if #"Is true" = true then
                #"Math By"
            else if #"Count Filtered" = 1 and #"Math By"[Kind]{0} = "Table" then
                fx("Data")(#"Math By"[Data]{0})
            else if #"Count Filtered" = 1 then
                #"Math By"[Data]{0}
            else
                #"Math By"
    in
        #"Selected Sheet"
