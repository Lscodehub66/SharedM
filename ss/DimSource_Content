// folderfiles
let
    Source = Load("DimSource"),
    Source_FD = Table.FromList(
        List.Select(
            List.Distinct(Source[FolderInput]),
            each
                if Text.StartsWith(_, "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\") then
                    _ = "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\"
                else
                    true
        )
    ),
    #"Invoked Custom Function" = Table.AddColumn(Source_FD, "Data", each fx("Folder2")([Column1], ".xls")),
    #"Expanded Data" = Table.ExpandTableColumn(
        #"Invoked Custom Function",
        "Data",
        List.RemoveItems(
            Table.ColumnNames(#"Invoked Custom Function"[Data]{0}), Table.ColumnNames(#"Invoked Custom Function")
        )
    ),
    #"Inserted Text Before Delimiter" = Table.AddColumn(
        #"Expanded Data",
        "PK_Excel2",
        each
            Text.BeforeDelimiter(
                Text.BeforeDelimiter(Text.BeforeDelimiter([Name], ".", {0, RelativePosition.FromEnd}), "-"), "_"
            ),
        type text
    ),
    // **Skipped**
    #"Merged Columns" = Table.Buffer(
        Table.CombineColumns(
            #"Inserted Text Before Delimiter",
            {"Folder Path", "Name"},
            Combiner.CombineTextByDelimiter("", QuoteStyle.None),
            "File Path"
        )
    ),
    #"Inserted Merged Column" = Table.AddColumn(
        #"Inserted Text Before Delimiter", "File Path", each Text.Combine({[Folder Path], [Name]}, ""), type text
    ),
    #"Removed Other Columns" = Table.SelectColumns(
        #"Inserted Merged Column", {"Content", "File Path", "PK_Excel2", "Folder Path"}
    )
in
    #"Removed Other Columns"
