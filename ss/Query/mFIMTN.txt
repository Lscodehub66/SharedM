
// mFIMTN
// let LoadCode = Load("mFIMTN","Code"), EVA = Expression.Evaluate(LoadCode ,#shared) in EVA
let
    Source = CWB("mFIMTN"),
    Merged = fxDynamicMerge(
            Source,
            DMI_all,
            "ISIN",
            "ISIN",
            {"发行期限(年)"},{""})
            in
            Merged

// SharedM
// SharedM
let
    GPS = try Excel.CurrentWorkbook(){[Name = "GPS"]}[Content][Column1]{0} otherwise "Remote",
    Source =
        try
            Folder.Files(
                if GPS = "Remote" then
                    "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\SharedM"
                else
                    "\\10.10.1.215\dcm$\Team Folder\Execution Team\DataHub\SharedM"
            ) otherwise Folder.Files("\\10.10.1.215\dcm$\Team Folder\Execution Team\DataHub\SharedM"),
    Merged = Table.AddColumn(
        Source,
        "Path",
        each
            if
                not Text.Contains([Name], "fx", Comparer.OrdinalIgnoreCase)
                and not Text.StartsWith([Name], "q", Comparer.OrdinalIgnoreCase)
            then
                [Folder Path] & "Q" & [Name]
            else
                Text.Combine({[Folder Path], [Name]}, ""),
        type text
    ),
    Filtered = Table.SelectRows(
       Merged,
        each
             Text.StartsWith([Name], "q", Comparer.OrdinalIgnoreCase)
                or Text.StartsWith([Name], "fx", Comparer.OrdinalIgnoreCase)
            
    ),
    Removed = Table.SelectColumns(Filtered, {"Name", "Path"})
in
    Removed