 // let Folder_Path ="File_Dimtbl[Folder_Path]{0}",Name_FText_InputCSV = null, PathName_InputFNum = "path",EXT_FText_Input ="xls",
(
    Folder_Path as text,
    optional Name_FText_InputCSV as nullable text,
    optional PathName_InputFNum as nullable number,
    optional EXT_FText_Input as text
) =>
    let
        SourceFolder = Folder.Files(Folder_Path),
        //
        Text_ContainsAny = Load("Text_ContainsAny"),
        //
        Name_FText = if Name_FText_InputCSV = null then "" else Text.Split(Name_FText_InputCSV, ","),
        Name_FText_IsExact = Text.Contains(Name_FText{0}, "="),
        Name_FText_Exact = Text.Replace(Name_FText{0}, "=", ""),
        FText_ExtText = if EXT_FText_Input = null then "" else EXT_FText_Input,
        //
        Filtered_1 = Table.SelectRows(
            SourceFolder,
            each
                not Text.Contains([Name], "~")
                and not Text.Contains([Name], "FID-NB")
                and not Text.Contains([Folder Path], "\ss\")
        ),
        Filtered_Name = Table.SelectRows(
            Filtered_1,
            each
                if Name_FText_IsExact = true then
                    Text.BeforeDelimiter([Name], ".", {0, RelativePosition.FromEnd}) = Name_FText_Exact
                else
                    Text_ContainsAny([Name], Name_FText)
        ),
        PathName_FNum_added = Table.AddColumn(
            Filtered_Name,
            "InputFNum",
            each
                if PathName_InputFNum = 0 or PathName_InputFNum = null then
                    0
                else if PathName_InputFNum > 9999 then
                    Text.Select(Text.AfterDelimiter([Folder Path], Folder_Path), {"0".."9"})
                else
                    Text.Select([Name], {"0".."9"}),
            type text
        ),
        PathName_FNum_Filtered = Table.SelectRows(
            PathName_FNum_added,
            each
                if PathName_InputFNum = 0 or PathName_InputFNum = 9999 or PathName_InputFNum = 99999999 then
                    true
                else
                    PathName_InputFNum = [InputFNum]
        ),
        FText_Ext_Filtered = Table.SelectRows(
            PathName_FNum_Filtered,
            each
                if FText_ExtText = "" then
                    true
                else
                    Text.Contains([Extension], FText_ExtText, Comparer.OrdinalIgnoreCase)
        ),
        TF_ColType = Table.TransformColumnTypes(FText_Ext_Filtered, {{"InputFNum", type number}}),
        SCol = Table.SelectColumns(TF_ColType, {"Content", "Name", "Extension", "Folder Path", "InputFNum"})
    in
        SCol
