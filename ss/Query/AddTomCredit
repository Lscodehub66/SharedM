let
 DMISectorMap_InQry = Table.FromRows (
  Json.Document (
   Binary.Decompress (
    Binary.FromText (
     "pZZpUipJEMfv4qeZiPcOMTGf3wkM79KIzaYgmyC7KAg4sogCbTUtl+msqr7FZC22QFcb8eJ9gaz/r7OWrKrMOj09YaM8HeR9p3ny4wRSbdqts+yIOtWTsx+nJ/gfR7r1GBIMl7TWMBEUfDKCSgJyd7AZxn3iNJm7hWLGxNlNmz16YLt0VjP658YsO/F3HUgY+2e9V7p8h60VpNPI8ZcWbhWxB+x8aiJgr323poUDokzazkOuf9SbGueqptepDNkbmtNHKPR0kCIks8YImQgjA+a+HZF+KdIPnfR5cn2oBeX7QPaqDTX7Erx0g05XGbS2oJ2i6o22szy7VLoaZzPEfdGCgQfuBbZMhI0t1OI9IZ+D+db3KghZdQXTog560nfXx1pWBMjOau0Iil0yEWViXAPr7pDQF497j/TmDX/F3GRzjwStdZAcq3lEYLjte0RNwicDvivy2QcM0oecNTxcPczWOAmxQcIYiwk1xpLzUQqKz9jCnTDxYDjDDQqXEjz08KwoUXEphNcrwhkhzE1/hUI2cSH8wVYrk6YYlhATRzdGHCTcc3EI3ZE6orbwzC8gszFyuRQlG7mM3IFsHEVfEZ6fywPuosGqPbzzkvvONIYoc+9yHXElwE1KZzUDZ7W62Jn7RTwPz4Rh/BXkWoLYzxgIn1yKgWTMF2/a55iwdJIuqkZSmIsctxmy8SVc576GjXTuzOH6AQmeycBqimP5UVFb+d9tYPXQgW/mJo4ENRPhmSc2IVowcNom0CYxntgyzqaSwHnE94lhpKuEcbTMDtoLUVe2FlzLFPSpqHW0pnBFYuAfOfM3h96K2apTo5vqGFo884zZA6ozM6+IbBrLlSAKmaiF17w4NH1FG3N2/i5isi0F9aU+BDKadhlI3URo3aaOE9bXqOegiOnCRHRq25dNX8lQUWuEGZ5383gUaPdCZKLKmvev1BSqOzatiU+UdgCh5WGFgMHoW/IXJvC/DzE/7/uuJ+73TSriewQN7tArmBzx/WCS8VbRj1fT/P/59a8QsKZW1ioEasN3naAxMRFlslGPy+Md4fjPVxff8HkCMs7vjQmDJpZXLRh4eDy0obMUff3KzOASNi3p94LKSC4rJ+O5Oj4o68p2zMXVerlEGctmyLGiBMOFWueD7e9mWjBw6BHWt+L91ZVTGdPo35riSzGeY/6mMqkJY1HVxf2ToJB+wrcn1qew7Bs/JMV4jhnZ9wpQuPzmE6uJ+V3cKlmFlLHHcZWiyoYvjwh3n7CE4S/vj01cvcvCKhnhKu/G948JHgYT8RCQHO9scLuEVCt8rrYXQece7JV4UBg4z7xzHDw8RRE+67MZVlkSTiFUDjmQKgYiwmktjVvkb+/gqSzTlzSkZ3EYVC0UaHl6SHxS5okq80omN9wQf9cXYZE5WjX3yec898jPn9jGn7Oz/wE=", 
     BinaryEncoding.Base64
    ), 
    Compression.Deflate
   )
  ), 
  let
   _t = ( ( type nullable text ) meta [ Serialized.Text = true ] )
  in
   type table [ 细分行业 = _t, 行业二级 = _t ]
 ), 
 Source             = Excel.CurrentWorkbook(){[ Name = "mCredit" ]}[Content], 
  Replaced细分行业       = Table.ReplaceValue ( Source, each [细分行业], each if List.PositionOf ( CWB_mBank[信用主体], [信用主体] ) > 0 then  CWB_mBank[细分行业]{List.PositionOf ( CWB_mBank[信用主体], [信用主体] }, Replacer.ReplaceValue, { "细分行业" } ), 
  ReplacedSector     = Table.ReplaceValue (Replaced细分行业 , each [行业二级], each DMISectorMap_InQry[行业二级]{List.PositionOf ( DMISectorMap_InQry[细分行业], [细分行业] )}, Replacer.ReplaceValue, { "行业二级" } ),  
 平台级别               = Table.ReplaceValue (
  板块分类, 
  null, 
  each 
   if [中资属性] <> "地方国企" then
    "--"
   else if Text.Contains ( [板块], "金融" ) then
    "--"
   else if [城市] = "--" and [区县] = "--" then
    "省级"
   else if [城市] <> "--" and [区县] = "--" then
    "市级"
   else if [城市] <> "--" and [区县] <> "--" then
    "区县级"
   else
    "", 
  Replacer.ReplaceValue, 
  { "平台级别" }
 ), 
 NullOut            = Table.SelectRows ( 平台级别, each ( [信用主体] <> null ) ), 
 DataType           = fxDataFormat ( NullOut ), 
 #">>ShowDupe"      = fxShowDupe ( DataType, { "信用主体" } ), 
 RemoveDupe         = Table.Distinct ( DataType, { "信用主体" } ), 
 PresentNull        = fxPresentNoData ( RemoveDupe ), 
 FnSort             = fxSortNIndex ( PresentNull, "DEBUT_DATE", "信用主体", "", "", "Y" )
in
 FnSort