(
    TableName as table,
    ColtblSameName as text,
    optional PrecedingColName as text,
    optional PrecedingColFTextInput as text
) =>
    let
        Source = TableName,
        CN_Source = Table.ColumnNames(Source),
        HD = List.Intersect({CN_Source, {ColtblSameName, PrecedingColName}}),
        HD_Count = List.Count(HD),
        SCol = Table.SelectColumns(Source, HD),
        Filtered =
            if HD_Count = 2 then
                Table.SelectRows(
                    SCol,
                    each
                        if PrecedingColFTextInput = null then
                            true
                        else
                            Record.Field(_, PrecedingColName) = PrecedingColFTextInput
                )
            else
                SCol,
        
        ExceltblName =
            if PrecedingColFTextInput = null then
                Text.Replace(ColtblSameName, "&", "_")
            else
                PrecedingColFTextInput & "_" & ColtblSameName ,
        MergedQ = Table.NestedJoin(
             Filtered, {ColtblSameName}, CWB(ExceltblName), {ColtblSameName}, "Data", JoinKind.LeftOuter
        ),
        ExpandedQ = Table.ExpandTableColumn(MergedQ, "Data", {"SortValue"}),
        NoBlank = Table.SelectRows(
            ExpandedQ, each not List.IsEmpty(List.RemoveMatchingItems(Record.FieldValues(_), {"", null}))
        ),
        Distincted = Table.Distinct( NoBlank ,{ColtblSameName}),
        Sorted = Table.Sort(Distincted, {{"SortValue", Order.Ascending}})
    in
        Sorted
