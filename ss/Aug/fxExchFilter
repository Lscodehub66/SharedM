( TableName as table ) =>
 let

  实质性违约名单 = Table.FromRows (
   Json.Document (
    Binary.Decompress (
     Binary.FromText (
      "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", 
      BinaryEncoding.Base64
     ), 
     Compression.Deflate
    )
   ), 
   let
    _t = ( ( type nullable text ) meta [ Serialized.Text = true ] )
   in
    type table [ 信用主体 = _t, 首次违约日 = _t ]
  ),  
  Removed = Table.RemoveColumns ( Source, { "违约日期", "IsEXCH" }, MissingField.Ignore ), 
  MergedQ = fxDynamicMerge ( Removed, 实质性违约名单, "信用主体", "信用主体", { "首次违约日" }, { "违约日期" } ), 
  TransformedType = Table.TransformColumnTypes ( MergedQ, { { "违约日期", type date } } ), 
  AddCol1 = Table.AddColumn (
   TransformedType, 
   "IsEXCH", 
   each if Text.Contains ( [特殊条款说明], "交换" ) or Text.Contains ( [特殊条款说明], "交換" ) or Text.Contains ( [特殊条款说明], "EXCH" ) then "Y" else if [违约日期] <> null and [定价日] > [违约日期] then "Y" else "--"
  ), 
  Removed1 = Table.RemoveColumns (  AddCol1, { "IsEXCH" } )
 in
  Removed1