// let LoadCode = Load("mIndice","Code"), EVA = Expression.Evaluate(LoadCode ,#shared) in EVA
let
    AddCode = Load("fxAddToDB", "Code"),
    ManagerCode = Load("fxDBManager", "Code"),
    DB = "mIndice",
    DB_Source = CWB(DB),
    DB_Source_CN = List.Buffer(Table.ColumnNames(DB_Source)),
    Parameter = Load("Controller")[RemoveFrom_DB]{0} ?? "",
    Added = fx("AddToDB")(DB, wIndicePQ, Parameter),
    Managed = if Text.Contains(Parameter, "Stop") then fx("DBManager")(DB_Source, "m") else fx(
        "DBManager"
    )(
        Added, "m"
    ),
    //mIndice only
    RCol = Table.RemoveColumns(
        Managed,
        List.Select(DB_Source_CN, each Text.StartsWith(_, "Column") or Text.Contains(_, "DAX")),
        MissingField.Ignore
    ),
    _CGBUSTSPD_Tenor = {"R_CGB_3Y", "R_UST_3Y", "S_DAX_CGBUSTSPD"},
    ACol = Table.AddColumn(
        RCol,
        _CGBUSTSPD_Tenor{2},
        each (Record.Field(_, _CGBUSTSPD_Tenor{0}) - Record.Field(_, _CGBUSTSPD_Tenor{1})) * 10000,
        type number
    ),
    AvgNum = List.Average(
        List.Buffer(
            Table.Column(Table.SelectRows(ACol, each [Date] > Date.FromText("2022/03/25")), _CGBUSTSPD_Tenor{2})
        )
    ),
    ACol2 = Table.AddColumn(ACol, _CGBUSTSPD_Tenor{2} & "_AVG", each AvgNum, type number),
    Reordered = Table.ReorderColumns(ACol2, DB_Source_CN, MissingField.Ignore)
in
    Reordered
