//let FileName = "CWB",Path  = if (try Excel.CurrentWorkbook(){[ Name = "GPS" ]}[Content][Column1]{0} otherwise "Remote" ) = "Remote" then "C:\Users\ktkt2\OneDrive\EXE Team\DataHub\SharedM\" else "\\itd-m09-fs02\dcm$\Team Folder\Execution Team\DataHub\SharedM\",  EVA = Expression.Evaluate ( Text.FromBinary ( Binary.Buffer ( File.Contents ( Path&FileName ) ) ) ,#shared )in    EVA//


(InputName as text, optional InputFnText as nullable text) =>
    let
        CurrentWorkbook = Excel.CurrentWorkbook(){[Name = InputName]}[Content],
        FText = Text.Replace(Text.Upper(Text.Trim(InputName)), "_", ""),
        FnFText = if InputFnText = null then "" else InputFnText,
        Source = if InputFnText = "1" then fx("Data")(CurrentWorkbook, 1) else fx("Data")(CurrentWorkbook),
        DefinedNames =
            if List.Contains(
                {"MONDAY", "UPDATORWEEKLY","REMOVEFROMDB" ,"澳门FILTER", "香港FILTER", "WEEKLYFILTER", "IS_EXCH_FILTER", "MULTISOURCE","GPS"},
                FText
            ) then
                Source[Column1]{0}
            else
                Source,
        List =
            if Text.StartsWith(FText, "CN") or Text.EndsWith(FText, "CN") or Text.StartsWith(FText, "HEADER") then
                Table.ToList(DefinedNames)
            else
                DefinedNames,
        GetCN = if Text.Contains(FnFText, "CN") then Table.ColumnNames(List) else List
    in
        GetCN
