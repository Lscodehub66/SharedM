//let Code = Load("Directory","Code"), EVA = Expression.Evaluate(Code ,#shared) in EVA
let
    Source = Table.Buffer(CWB("BISL_Ancient")),
    deal_masterB = Table.Buffer(deal_master),
    BaseDirectoryCN = List.Buffer(CWB("BaseDirectory_CN")),
    //
    Ancient_Merged = Load("fxDBMerger")(Source),
    Ancient_Finalized = Load("fxDBFinalization")(Ancient_Merged),
    deal_masterFiltered = Table.SelectRows(deal_masterB, each [BISL_ROLE] <> "" and [BISL_ROLE] <> "--"),
    Combined = Load("fxCombine")({Ancient_Finalized, deal_masterFiltered}, null, {1}),
    Checked = Load("fxCheckNDupe")(Combined),
    MergedQ = Load("fxMerge")(Checked, CWB("Table_PRJMerge"), "COMPARER", "COMPARER", {"承销费原币"}, {""}),
    NthMandate = fx("NthMandated")(MergedQ, {"YYMMDD", "信用主体"}),
    Sorted = Load("fxSortNIndex")(NthMandate),
    ReplacedCCY = Table.ReplaceValue(Sorted, "美元债", "", Replacer.ReplaceValue, {"货币细分"}),
    Reordered = Table.ReorderColumns(
        ReplacedCCY,
        BaseDirectoryCN & List.RemoveMatchingItems(Table.ColumnNames(ReplacedCCY), BaseDirectoryCN),
        MissingField.Ignore
    )
in
    Reordered
