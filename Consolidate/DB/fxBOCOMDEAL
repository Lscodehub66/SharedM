( TableName as table ) =>
 let
  Source        = TableName, 
  RemovedCol    = Table.RemoveColumns ( Source, { "BOCOM_DEAL?" }, MissingField.Ignore ), 
  NAToBlank     = Table.ReplaceValue ( RemovedCol, "--", "", Replacer.ReplaceValue, { "BISL_ROLE", "港分_ROLE", "澳分_ROLE" } ), 
  NullToBlank   = Table.ReplaceValue ( NAToBlank, null, "", Replacer.ReplaceValue, { "BISL_ROLE", "港分_ROLE", "澳分_ROLE" } ), 
  AddedCol      = Table.AddColumn ( NullToBlank, "BISL", each if [BISL_ROLE] <> "" then "BISL" else "" ), 
  AddedCol1     = Table.AddColumn ( AddedCol, "港分", each if Text.Contains ( [港分_ROLE], "*" ) then [港分_ROLE] else if [港分_ROLE] <> "" then "港分" else "" ), 
  AddedCol2     = Table.AddColumn ( AddedCol1, "澳分", each if [澳分_ROLE] <> "" then "澳分" else "" ), 
  MergedCol     = Table.AddColumn ( AddedCol2, "BOCOM_DEAL?", each Text.Combine ( { [BISL], [港分], [澳分] }, "" ), type text ), 
  RepalcedText  = Table.ReplaceValue ( MergedCol, "BISL港分", "BISL,港分", Replacer.ReplaceText, { "BOCOM_DEAL?" } ), 
  RepalcedText1 = Table.ReplaceValue ( RepalcedText, "BISL澳分", "BISL,澳分", Replacer.ReplaceText, { "BOCOM_DEAL?" } ), 
  ReplacedText2 = Table.ReplaceValue ( RepalcedText1, "港分澳分", "港分,澳分", Replacer.ReplaceText, { "BOCOM_DEAL?" } ), 
  RemovedCol1   = Table.RemoveColumns ( ReplacedText2, { "BISL", "港分", "澳分" } )
 in
  RemovedCol1